<html>
  <head>
    <meta content='Introduction to Jaggery.js from CmbJS - Tinker's thoughts~' property='og:title' />
    <title>Introduction to Jaggery.js from CmbJS - Tinker's thoughts~</title>
    <link href='/images/fav.png' rel='shortcut icon'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css' />
<link href='/stylesheets/style.css' rel='stylesheet' type='text/css' />
<link href='/stylesheets/syntax.css' rel='stylesheet' type='text/css' />
<link href='/stylesheets/responsive.css' rel='stylesheet' type='text/css' />
<link href='/stylesheets/custom.css' rel='stylesheet' type='text/css' />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link href='/stylesheets/all-2751ab1d048569196037b7afce0ca9bb.css' media='all' rel='stylesheet' type='text/css'>
<!-- - -->
<script src='/javascripts/jquery.js' type='text/javascript'></script>
<script src='/javascripts/pd.js' type='text/javascript'></script>
<script src='/javascripts/basics.js' type='text/javascript'></script>
<script src='/javascripts/custom.js' type='text/javascript'></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<!-- - -->
<meta content='width=device-width, initial-scale=1.0, user-scalable=no' name='viewport'>
<meta content='text/html; charset=utf-8' http-equiv='content-type' />
<meta content="/og.png" property="og:image" />
<meta content="164540446948" property="fb:app_id" />

  <meta content='/javascript/2014/02/18/introduction-to-jaggery-dot-js-from-cmbjs/' property='og:url' />
  <meta content="We had the 3rd [JavaScript meetup](http://www.meetup.com/Colombo-JS-Meetup/events/163220432/) on February 13th until ..." property='og:description' />
  <meta content="article" property="og:type" />

<!-- - -->
<script type='text/javascript'>
  //<![CDATA[
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47839614-1']);
    _gaq.push(['_trackPageview']);
    
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  //]]>
</script>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=164540446948";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
  </head>
  <body>
    <header>
<!-- <a id="go-back-home" href=""><img src="/images/scribble.png" alt="scribble" width="53" height="59"></a> -->
<a id="go-back-home" href="/"><i class="fa fa-code-fork fa-5x"></i></a>
<p>Tinker's thoughts~</p>
</header>
    <div id='container'>
      <div class="block">
  
    <a target="_top"
       class="main" 
       href="/about">
       About
     </a>
  
    <a target="_top"
       class="main" 
       href="/blog">
       Blog
     </a>
  
    <a target="_blank"
       class="main" 
       href="http://github.com/dulichan">
       GitHub
     </a>
  
</div>
      <section class="paging">
  
    <div class="left">
      <a href="/git/2014/02/07/git-tips/">
        ‹
      </a>
    </div>
  
  
    <div class="right">
      <a href="/ruby/2014/02/28/running-shoes-apps-in-mac-os-x/">
        ›
      </a>
    </div>
  
</section>
      <div class="content">
        <section class='post'>
          <h1 class="upcase">
            <div class='date'>18 Feb 2014</div>
            Introduction to Jaggery.js from CmbJS
          </h1>
          <p>We had the 3rd <a href="http://www.meetup.com/Colombo-JS-Meetup/events/163220432/">JavaScript meetup</a> on February 13th until I ruinedined everyone&rsquo;s life by coding in my talk :). Now it&rsquo;s time to spread some light to people who didn&rsquo;t understood my talk.</p>

<h2>Slides</h2>

<p>First is the <a href="https://speakerdeck.com/dulichan/introduction-to-jaggery-dot-js">slide deck</a>. It doesn&rsquo;t have much slides but gives a list of features of jaggery.</p>

<h2>Hands-on jaggery.js</h2>

<p>Next is the interesting bit where we develop a todo-list app from scratch. I am using Angular for this project since I am tried of binding stuff to my UIs. </p>

<p>First clone the <a href="https://github.com/dulichan/jaggery-handson">Github project</a> for the hands-on exercise. I took [Grunt] and [Yeoman] as the tools to scaffold the app. </p>

<p>Next download the Jaggery server from the <a href="http://jaggeryjs.org/">jaggerjs site</a> and extract the server. In the server there is a folder called apps. This folder has all the apps that will be deployed when the server starts up. To start up the server run <code>sh bin/server.sh</code>. I have [soft linked] the cloned repo&rsquo;s app folder to the apps folder of the jaggery server.</p>

<h2>Basic html &amp; javascript</h2>

<p>When you browse to <code>https://localhost:9763/apps/app</code> it will show a scaffolded page. Next we are going to remove that content and place a list with some angular directives. </p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>main1.html</span><a class='code-highlight-caption-link' href='https://gist.github.com/9cf0136024aefcddded9'>link</a></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nt">&lt;h1&gt;</span>Jaggery intro<span class="nt">&lt;/h1&gt;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nt">&lt;ul</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;li&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo.status&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;span</span> <span class="na">ng-model=</span><span class="s">&quot;todo.text&quot;</span><span class="nt">&gt;</span>&#x7b;&#x7b;todo.text&#x7d;&#x7d;<span class="nt">&lt;/span&gt;&lt;/li&gt;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nt">&lt;/ul&gt;</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;/div&gt;</span></div></div></pre></div></figure>

<p>When we have the todos object in the <a href="http://docs.angularjs.org/guide/scope">angular scope</a>, it will be looped and added as <code>&lt;li&gt;</code> elements to the list. Now we need to code up the javascript to put the todos to the scope.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>app/scripts/controllers/main.js</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;3rdMeetupApp&#39;</span><span class="p">)</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;First task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">0</span><span class="p">&#x7d;,&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;Second Task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">1</span><span class="p">&#x7d;,&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;Third Task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">0</span><span class="p">&#x7d;</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">];</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">&#x7d;);</span></div></div></pre></div></figure>

<p>Next objective is to get the todo items from the server side. Before go further we have to know little bit about the jaggery.conf file.</p>

<h2>jaggery.conf to the rescue</h2>

<p>If you are coming from the Java EE background you would know about the <a href="http://en.wikipedia.org/wiki/Deployment_descriptor">web.xml</a> file. Jaggery&rsquo;s configuration file for the app is called <a href="http://jaggeryjs.org/apidocs/jagconf.jag">jaggery.conf</a> - it is used for </p>

<ul>
<li>URL mappings</li>
<li>specifying log level</li>
<li>basic authentication</li>
<li>error pages</li>
</ul>

<p>We are going to add a <code>jaggery.conf</code> file for our app as well.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>jaggery.conf</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7b;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&quot;displayName&quot;</span><span class="p">:</span><span class="s2">&quot;JSMeetup&quot;</span><span class="p">,</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&quot;logLevel&quot;</span> <span class="p">:</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&quot;urlMappings&quot;</span> <span class="p">:</span> <span class="p">[</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7b;</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nt">&quot;url&quot;</span> <span class="p">:</span> <span class="s2">&quot;/api/*&quot;</span><span class="p">,</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nt">&quot;path&quot;</span> <span class="p">:</span> <span class="s2">&quot;/router.jag&quot;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">]</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;</span></div></div></pre></div></figure>

<p>What this will basically do is - map all the requests that arrive to <code>api/*</code> URL pattern to the <code>router.jag</code> file. </p>

<h2>.jag files</h2>

<p>After mentioned the <code>.jag</code> files you might be confused as to what&rsquo;s this new extension. <code>.jag</code> is the extension used for jaggery.js server pages. Below is our <code>router.jag</code> file.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>router.jag</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">&lt;%</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">goose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;/modules/goose.js&quot;</span><span class="p">).</span><span class="nx">goose</span><span class="p">;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">goose</span><span class="p">(&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">CONTEXT</span><span class="o">:</span> <span class="s2">&quot;/jsmeetup/api/&quot;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Log</span><span class="p">();</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="kd">var</span> <span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;First task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">0</span><span class="p">&#x7d;,&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;Second Task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">1</span><span class="p">&#x7d;,&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;Third Task&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="mi">0</span><span class="p">&#x7d;</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">];</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">print</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span> <span class="o">%&gt;</span></div></div></pre></div></figure>

<p>We have used a module called <a href="https://github.com/dulichan/goose.js">goose.js</a> that is used for jaggery routing and added a route for <code>todos</code> endpoint. We&rsquo;ll also change our client side accordingly.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>app/scripts/controllers/main.js</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;3rdMeetupApp&#39;</span><span class="p">)</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="kd">var</span> <span class="nx">BS</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Better call Saul!!!&quot;</span><span class="p">);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)&#x7b;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">&#x7d;);</span></div></div></pre></div></figure>

<h2>Querying the Database</h2>

<p>Jaggery.js has a neat feature to get database tables as json objects. First we have to download the driver of the database, in my case <a href="http://dev.mysql.com/downloads/connector/j/">MySQL driver</a> and place the driver in the <code>JAGGERY_HOME/carbon/repository/components/lib</code> folder.</p>

<p>I am also going to create a table called <code>todos</code> in a database. Below is the SQL for the table -</p>

<figure class='code-highlight-figure'><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">todos</span><span class="o">`</span> <span class="p">(</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">unsigned</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">`</span><span class="nb">text</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">`</span><span class="n">status</span><span class="o">`</span> <span class="n">tinyint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">11</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span></div></div></pre></div></figure>

<p>Next I am changing the <code>router.jag</code> to query the database.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>router.jag</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">&lt;%</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">goose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;/modules/goose.js&quot;</span><span class="p">).</span><span class="nx">goose</span><span class="p">;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">goose</span><span class="p">(&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">CONTEXT</span><span class="o">:</span> <span class="s2">&quot;/jsmeetup/api/&quot;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Log</span><span class="p">();</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Database</span><span class="p">(</span><span class="s2">&quot;jdbc:mysql://localhost:3306/test&quot;</span><span class="p">,</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="kd">var</span> <span class="nx">todos</span> <span class="o">=</span> <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM todos&quot;</span><span class="p">);</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">print</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span> <span class="o">%&gt;</span></div></div></pre></div></figure>

<p>If you view the page now - you&rsquo;ll see that the rows in the table got rendered to the list. </p>

<h2>Adding a new todo</h2>

<p>Next we are going to add a new todo to the table. First we are going to create the form and the client side javascript required.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>main2.html</span><a class='code-highlight-caption-link' href='https://gist.github.com/9cf0136024aefcddded9'>link</a></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;h1&gt;</span>Jaggery intro<span class="nt">&lt;/h1&gt;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;ul</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;li&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo.status&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;span</span> <span class="na">ng-model=</span><span class="s">&quot;todo.text&quot;</span><span class="nt">&gt;</span>&#x7b;&#x7b;todo.text&#x7d;&#x7d;<span class="nt">&lt;/span&gt;&lt;/li&gt;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;/ul&gt;</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;form</span> <span class="na">ng-submit=</span><span class="s">&quot;addTodo()&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todoText&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;add new todo here&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;add&quot;</span> <span class="na">class=</span><span class="s">&quot;btn-primary&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;/form&gt;</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;/div&gt;</span></div></div></pre></div></figure>

<p>We added the <code>ng-submit</code> directive to evoke a javascript method when the form is submitted.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>app/scripts/controllers/main.js</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;3rdMeetupApp&#39;</span><span class="p">)</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="kd">var</span> <span class="nx">BS</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Better call Saul!!!&quot;</span><span class="p">);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="kd">var</span> <span class="nx">list_todos</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)&#x7b;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">addTodo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$http</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">,</span> <span class="p">&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">todoText</span><span class="p">&#x7d;).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nx">list_todos</span><span class="p">();</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">list_todos</span><span class="p">();</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">&#x7d;);</span></div></div></pre></div></figure>

<p>In our controller we also extracted the logic to get new todos to a method called <code>list_todos()</code>. Calling this method when the script runs will add the todos to the current scope. Also when a new todo is added it will rerun the method to get the new todos from the server and adding it to the current scope. </p>

<p>Now we are going to prepare the server side for the adding of a todo item.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>router.jag</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">&lt;%</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">goose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;/modules/goose.js&quot;</span><span class="p">).</span><span class="nx">goose</span><span class="p">;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">goose</span><span class="p">(&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">CONTEXT</span><span class="o">:</span> <span class="s2">&quot;/jsmeetup/api/&quot;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Log</span><span class="p">();</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Database</span><span class="p">(</span><span class="s2">&quot;jdbc:mysql://localhost:3306/test&quot;</span><span class="p">,</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="kd">var</span> <span class="nx">todos</span> <span class="o">=</span> <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM todos&quot;</span><span class="p">);</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">print</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)&#x7b;</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO `todos` (`text`, `status`) VALUES (?, 0);&quot;</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">text</span><span class="p">);</span>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span> <span class="o">%&gt;</span></div></div></pre></div></figure>

<h2>Ticking a todo</h2>

<p>Now what&rsquo;s left is crossing off a todo when it&rsquo;s done. For this we are going to modify the html of the view first.
<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>main3.html</span><a class='code-highlight-caption-link' href='https://gist.github.com/9cf0136024aefcddded9'>link</a></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;h1&gt;</span>Jaggery intro<span class="nt">&lt;/h1&gt;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;ul</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;li&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">ng-click=</span><span class="s">&quot;check(todo)&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo.status&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;span</span> <span class="na">ng-model=</span><span class="s">&quot;todo.text&quot;</span><span class="nt">&gt;</span>&#x7b;&#x7b;todo.text&#x7d;&#x7d;<span class="nt">&lt;/span&gt;&lt;/li&gt;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;/ul&gt;</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;form</span> <span class="na">ng-submit=</span><span class="s">&quot;addTodo()&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todoText&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;add new todo here&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;add&quot;</span> <span class="na">class=</span><span class="s">&quot;btn-primary&quot;</span><span class="nt">&gt;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nt">&lt;/form&gt;</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nt">&lt;/div&gt;</span></div></div></pre></div></figure></p>

<p>Only change we did was add a <code>ng-click</code> event to the checkbox. This will trigger the associated javascript event with the current todo as a parameter. In the client side we are going to capture this and send it to the server.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>app/scripts/controllers/main.js</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;3rdMeetupApp&#39;</span><span class="p">)</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="kd">var</span> <span class="nx">BS</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Better call Saul!!!&quot;</span><span class="p">);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="kd">var</span> <span class="nx">list_todos</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)&#x7b;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">addTodo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$http</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">,</span> <span class="p">&#x7b;</span><span class="nx">text</span><span class="o">:</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">todoText</span><span class="p">&#x7d;).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nx">list_todos</span><span class="p">();</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">check</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)&#x7b;</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="nx">$http</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&quot;api/todos&quot;</span><span class="p">,</span> <span class="p">&#x7b;</span><span class="nx">id</span><span class="o">:</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span><span class="nx">todo</span><span class="p">.</span><span class="nx">status</span><span class="p">&#x7d;).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">()&#x7b;</span>
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="nx">list_todos</span><span class="p">();</span>
</div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="p">&#x7d;).</span><span class="nx">error</span><span class="p">(</span><span class="nx">BS</span><span class="p">);</span>
</div></div><div data-line='21' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="p">&#x7d;</span>
</div></div><div data-line='22' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">list_todos</span><span class="p">();</span>
</div></div><div data-line='23' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="p">&#x7d;);</span></div></div></pre></div></figure>

<p>Next tweak the <code>router.jag</code> to handle the new <code>put</code> API call.</p>

<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>router.jag</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">&lt;%</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">goose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;/modules/goose.js&quot;</span><span class="p">).</span><span class="nx">goose</span><span class="p">;</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">goose</span><span class="p">(&#x7b;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">CONTEXT</span><span class="o">:</span> <span class="s2">&quot;/jsmeetup/api/&quot;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Log</span><span class="p">();</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="kd">var</span> <span class="nx">database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Database</span><span class="p">(</span><span class="s2">&quot;jdbc:mysql://localhost:3306/test&quot;</span><span class="p">,</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">&#x7b;</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="kd">var</span> <span class="nx">todos</span> <span class="o">=</span> <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM todos&quot;</span><span class="p">);</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="nx">print</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)&#x7b;</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO `todos` (`text`, `status`) VALUES (?, 0);&quot;</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">text</span><span class="p">);</span>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&quot;todos&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)&#x7b;</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="kd">var</span> <span class="nx">status</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">status</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;UPDATE `todos` SET `status`=? WHERE `id`=?&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;);</span>
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="nx">router</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span> <span class="o">%&gt;</span></div></div></pre></div></figure>

<p>Voila - a completed todo list. As you saw above Jaggery.js provides support to build server-side javascript apps quickly and efficiently. Maybe the example might look a little bit complex for people who are new to <a href="http://angularjs.org/">Angular</a> but even so you can understand how easy it was to build a backend API. </p>

          <br />
<p>
  Till next time mate,<br/>
  Dulitha
  <span class="muted">at 20:19</span>
</p>


        </section>
      </div>
      
        <div class="block">

  <div class="button">
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </div>

    <div class="button spaced">
      <div class="fb-like" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial" data-action="like"></div>
    </div>
</div>
      

      
        <div class="block">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      var disqus_shortname = "duli-chan"; 
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      
      <div class="block">
  
    <a target="_top"
       class="main" 
       href="/about">
       About
     </a>
  
    <a target="_top"
       class="main" 
       href="/blog">
       Blog
     </a>
  
    <a target="_blank"
       class="main" 
       href="http://github.com/dulichan">
       GitHub
     </a>
  
</div>
    </div>
    <footer>
  <p>~Code is Poetry~</p>
  <a id="go-back-home" href=""><i class="fa fa-code-fork fa-2x"></i></a>
</footer>
  </body>
</html>
